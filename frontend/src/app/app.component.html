<div class="main-wrapper">
  @if (!isLoggedIn) {
    <app-login 
      (loginEvent)="onLogin($event.u, $event.p)"
      (registerEvent)="onRegister($event.u, $event.p)">
    </app-login>
  } 

  @else {
    <div class="dashboard fade-in">
      <nav class="sidebar">
        <div class="logo">JD</div>
        <ul>
          <li [class.active]="currentView === 'home'" (click)="setView('home')">Home</li>
          <li [class.active]="currentView === 'crypto'" (click)="setView('crypto')">Crypto</li>
          <li [class.active]="currentView === 'finance'" (click)="setView('finance')">Finance</li>
          <li (click)="logout()" class="logout-link">Logout</li>
        </ul>
      </nav>

      <main class="content">
        @if (currentView === 'home') {
          <app-project-tracker 
            [allProjects]="allProjects" 
            [userRole]="userRole"
            (addProjectEvent)="addProject($event.title, $event.desc)"
            (deleteProjectEvent)="deleteProject($event)"
            (toggleStatusEvent)="toggleStatus($event)"
            (addTaskEvent)="addTask($event.id, $event.text)"
            (refreshEvent)="syncData()">
          </app-project-tracker>
        }

        @if (currentView === 'crypto') {
         <app-crypto-hub 
  [currentUser]="currentUsername" 
  [allTrades]="allTrades"
  [totalTrades]="allTrades.length"
  [winRate]="winRate"
  [totalNetProfit]="cryptoNet"
  (tradeAddedEvent)="addTrade($event)">
</app-crypto-hub>
        }

        @if (currentView === 'finance') {
  <app-finance-manager 
    #financeRef
    [allFinance]="allFinance" 
    [allIncome]="allIncome" 
    [goals]="goals" 
    [totalIncome]="totalIncome" 
    [totalExpenses]="totalExpenses" 
    [totalNetBalance]="netBalance"
    [capitalOneBalance]="capOne" 
    [santanderBalance]="santander"
    
    (addExpenseEvent)="addFinance($event)" 
    (deleteExpenseEvent)="deleteFinance($event)"
    (addIncomeEvent)="addIncome($event)" 
    (deleteIncomeEvent)="deleteIncome($event)"
    (addGoalEvent)="addGoal($event)"
    (updateGoalEvent)="updateGoal($event)"
    (deleteGoalEvent)="deleteGoal($event)">
  </app-finance-manager>
}
      </main>
    </div>
  }
</div>