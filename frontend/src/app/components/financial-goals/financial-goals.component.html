<section class="card goals-overview-section" style="margin-top: 20px;">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
    <h2 style="margin: 0;">ğŸ¯ Financial Goals</h2>
    <button class="primary-btn" style="width: auto; padding: 5px 15px;" (click)="showGoalForm = !showGoalForm">
      {{ showGoalForm ? 'Close' : '+ New Goal' }}
    </button>
  </div>

  @if (showGoalForm) {
    <div class="add-goal-card" style="margin-bottom: 20px; padding: 15px; background: #2a2a2a; border-radius: 8px;">
      <div style="display: flex; gap: 10px; flex-wrap: wrap;">
        <input type="text" #gName placeholder="Goal Name" style="flex: 2;">
        <input type="number" #gTarget placeholder="Target $" style="flex: 1;">
        <input type="date" #gDate style="flex: 1;">
        <button class="primary-btn" style="flex: 1;" (click)="onAddGoal(gName.value, gTarget.value, gDate.value)">Create</button>
      </div>
    </div>
  }

  <div class="goals-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px;">
    @for (goal of goals; track goal._id) {
      <div class="goal-item-card" style="background: #1e1e1e; padding: 15px; border-radius: 10px; border: 1px solid #333;">
        <div style="display: flex; justify-content: space-between;">
          <h4 style="margin: 0;">{{ goal.name }}</h4>
          <span style="font-size: 0.8rem; color: #888;">{{ goal.deadline | date }}</span>
        </div>
        <div style="display: flex; justify-content: space-between; margin-top: 10px; font-size: 0.9rem;">
          <span>{{ goal.currentAmount | currency }} / {{ goal.targetAmount | currency }}</span>
          <span style="font-weight: bold;">{{ getPercent(goal.currentAmount, goal.targetAmount) | number:'1.0-0' }}%</span>
        </div>
        <div class="progress-bar-bg" style="background: #333; height: 10px; border-radius: 5px; margin: 10px 0; overflow: hidden;">
          <div class="progress-bar-fill" 
               [style.width.%]="getPercent(goal.currentAmount, goal.targetAmount)"
               [style.background]="getPercent(goal.currentAmount, goal.targetAmount) >= 100 ? '#28a745' : '#007bff'"
               style="height: 100%; transition: width 0.5s ease;">
          </div>
        </div>
        <div class="goal-actions" style="display: flex; gap: 5px;">
          <input type="number" #updateAmt placeholder="+ Add $" style="flex: 1; padding: 5px;">
          <button class="primary-btn" style="padding: 5px 10px;" (click)="onUpdateGoal(goal._id, updateAmt.value); updateAmt.value=''">Update</button>
          <button class="row-delete-btn" (click)="onDeleteGoal(goal._id)">ğŸ—‘ï¸</button>
        </div>
      </div>
    }
  </div>
</section>